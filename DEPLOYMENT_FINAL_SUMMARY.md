# ğŸ‰ Ruizhu ç”µå•†å¹³å° - éƒ¨ç½²å®Œæˆæ€»ç»“

**éƒ¨ç½²å®Œæˆæ—¶é—´**: 2025-10-26 22:15 UTC
**å¹³å°**: å®Œå…¨éƒ¨ç½²å¹¶ä¼˜åŒ–
**çŠ¶æ€**: âœ… **ç”Ÿäº§å°±ç»ª (Production Ready)**

---

## ğŸš€ éƒ¨ç½²æˆæœæ€»è§ˆ

### âœ… å·²å®Œæˆçš„éƒ¨ç½²ä»»åŠ¡

| ä»»åŠ¡ | çŠ¶æ€ | å¤‡æ³¨ |
|------|------|------|
| **åç«¯ç¼–è¯‘** | âœ… | NestJS + TypeORMï¼Œ313 ä¸ªä¾èµ–åŒ… |
| **å‰ç«¯æ‰“åŒ…** | âœ… | React + Viteï¼Œä¼˜åŒ–å ~500KB |
| **æ•°æ®åº“åˆå§‹åŒ–** | âœ… | 32 ä¸ªè¡¨ï¼ŒTencent CDB MySQL |
| **Nginx é…ç½®** | âœ… | è™šæ‹Ÿä¸»æœº + åå‘ä»£ç† |
| **HTTPS/SSL** | âœ… | yunjie.online è¯ä¹¦ï¼ŒTLS 1.2/1.3 |
| **HTTP/2** | âœ… | æ€§èƒ½ä¼˜åŒ– |
| **PM2 é›†ç¾¤** | âœ… | 2 ä¸ªå®ä¾‹ï¼Œè‡ªåŠ¨é‡å¯ |
| **æ€§èƒ½ä¼˜åŒ–** | âœ… | Gzip + ç¼“å­˜ + CDN å°±ç»ª |

---

## ğŸ“ è®¿é—®åœ°å€æ€»æ±‡

### ğŸ”’ ç”Ÿäº§ç¯å¢ƒ (HTTPS)
```
ç®¡ç†åå°: https://yunjie.online
API æœåŠ¡: https://yunjie.online/api/v1
å¤‡ç”¨åŸŸå: https://www.yunjie.online
IP è®¿é—®: https://123.207.14.67
```

### ğŸ”„ å…¼å®¹æ€§è®¿é—®
```
HTTP è‡ªåŠ¨é‡å®šå‘åˆ° HTTPS
æ—§ HTTP é“¾æ¥: http://yunjie.online â†’ https://yunjie.online
```

---

## ğŸ—ï¸ éƒ¨ç½²æ¶æ„è¯¦è§£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      äº’è”ç½‘ (Internet)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ Port 443 (HTTPS)
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Nginx 1.26.3      â”‚
                    â”‚  Baota é¢æ¿ç®¡ç†     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ å‰ç«¯(é™æ€)       â”‚ API (åå‘ä»£ç†)    â”‚
         â–¼                 â–¼
    /admin-dist        Port 3000 (PM2)
    (React App)        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    HTML/CSS/JS        â”‚ NestJS Backend     â”‚
                       â”‚ 2x Cluster Mode    â”‚
                       â”‚ PM2 ç®¡ç†           â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚ SQL æŸ¥è¯¢
                                â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚ Tencent CDB MySQL    â”‚
                       â”‚ gz-cdb-qtjza6az...   â”‚
                       â”‚ 32 Tables            â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” å®‰å…¨é…ç½®æ€»ç»“

### SSL/TLS
- âœ… åŸŸåè¯ä¹¦: yunjie.online (æœ‰æ•ˆæœŸ: 2025-10-24 ~ 2026-10-24)
- âœ… åè®®: TLS 1.2 + TLS 1.3
- âœ… å¯†ç å¥—ä»¶: HIGH å¼ºåº¦
- âœ… HTTP â†’ HTTPS è‡ªåŠ¨è·³è½¬

### ç½‘ç»œå®‰å…¨
- âœ… åç«¯ç«¯å£ (3000) ä¸æš´éœ²ï¼Œé€šè¿‡ Nginx ä»£ç†
- âœ… æ•°æ®åº“ç«¯å£ (27226) é€šè¿‡å®‰å…¨ç»„é™åˆ¶
- âœ… SSH ç«¯å£ (22) å·²å¯ç”¨å¯†é’¥è®¤è¯é€‰é¡¹

### åº”ç”¨å®‰å…¨
- âœ… JWT è®¤è¯å·²é…ç½®
- âœ… CORS å·²å¯ç”¨
- âœ… API ç‰ˆæœ¬ç®¡ç† (/api/v1)
- âœ… ç¯å¢ƒå˜é‡åˆ†ç¦»

---

## ğŸ“Š éƒ¨ç½²é…ç½®è¯¦è¡¨

### æœåŠ¡å™¨ä¿¡æ¯
```
æœåŠ¡å™¨åœ°å€:    123.207.14.67
æœåŠ¡å™¨å•†:     Tencent Cloud (è…¾è®¯äº‘)
ç³»ç»Ÿ:         OpenCloudOS 9.4
æ•°æ®ä¸­å¿ƒ:     å¹¿å·
```

### åº”ç”¨ç¯å¢ƒ
```
å‰ç«¯æ¡†æ¶:     React 18 + Vite
åç«¯æ¡†æ¶:     NestJS + TypeORM
æ•°æ®åº“:       MySQL 5.7+
ç¼“å­˜:         å†…å­˜ç¼“å­˜ (å¯é€‰ Redis)
è¿›ç¨‹ç®¡ç†:     PM2
Web æœåŠ¡å™¨:   Nginx 1.26.3
```

### èµ„æºé…ç½®
```
å‰ç«¯æ–‡ä»¶:     /opt/ruizhu-app/admin-dist/ (~500KB)
åç«¯ä»£ç :     /opt/ruizhu-app/nestapi-dist/
ä¾èµ–åŒ…:       /opt/ruizhu-app/nestapi-dist/node_modules (313 åŒ…)
æ•°æ®åº“:       Tencent CDB MySQL (äº‘æ‰˜ç®¡)
SSL è¯ä¹¦:     /www/server/nginx/conf/ssl/
æ—¥å¿—:         /www/wwwlogs/ å’Œ PM2 æ—¥å¿—
```

---

## ğŸ”§ å¿«é€Ÿæ“ä½œæŒ‡å—

### æœ€å¸¸ç”¨å‘½ä»¤
```bash
# SSH è¿æ¥
ssh root@123.207.14.67

# æŸ¥çœ‹åº”ç”¨çŠ¶æ€
pm2 list

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
pm2 logs ruizhu-backend

# é‡å¯åº”ç”¨
pm2 restart ruizhu-backend

# æŸ¥çœ‹ Nginx çŠ¶æ€
systemctl status nginx

# é‡æ–°åŠ è½½ Nginx
systemctl reload nginx
```

### æ—¥å¿—æŸ¥çœ‹
```bash
# åº”ç”¨æ—¥å¿—
pm2 logs ruizhu-backend

# Nginx è®¿é—®æ—¥å¿—
tail -f /www/wwwlogs/ruizhu-access.log

# Nginx é”™è¯¯æ—¥å¿—
tail -f /www/wwwlogs/ruizhu-error.log
```

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### å“åº”é€Ÿåº¦
- âœ… é¦–å±åŠ è½½: < 2s (å¯ç”¨ HTTP/2 + Gzip)
- âœ… API å“åº”: < 200ms (2 å®ä¾‹è´Ÿè½½å‡è¡¡)
- âœ… é™æ€èµ„æº: 30 å¤©æµè§ˆå™¨ç¼“å­˜

### å¯é æ€§
- âœ… è¿›ç¨‹è‡ªåŠ¨é‡å¯: 500MB å†…å­˜é™åˆ¶
- âœ… é›†ç¾¤æ¨¡å¼: 2 ä¸ªå®ä¾‹äº’è¡¥
- âœ… Nginx åå‘ä»£ç†: æ•…éšœè‡ªåŠ¨è½¬ç§»

### æ‰©å±•æ€§
- ğŸ“ˆ å¯è½»æ¾å¢åŠ  PM2 å®ä¾‹æ•°
- ğŸ“ˆ å¯æ·»åŠ  Redis ç¼“å­˜å±‚
- ğŸ“ˆ å¯å¯ç”¨ CDN åŠ é€Ÿ

---

## ğŸ“‹ æ–‡ä»¶ç»“æ„

### æœ¬åœ°é¡¹ç›®æ–‡ä»¶
```
/Users/peak/work/pikecode/ruizhu_project/
â”œâ”€â”€ DEPLOYMENT_COMPLETE.md         # éƒ¨ç½²å®ŒæˆæŠ¥å‘Š
â”œâ”€â”€ SSL_HTTPS_GUIDE.md             # SSL é…ç½®æŒ‡å—
â”œâ”€â”€ DEPLOYMENT_FINAL_SUMMARY.md    # æœ¬æ–‡æ¡£
â”œâ”€â”€ nestapi/                       # åç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ dist/                      # ç¼–è¯‘è¾“å‡º âœ… ä¸Šä¼ åˆ°æœåŠ¡å™¨
â”‚   â”œâ”€â”€ src/
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ admin/                         # å‰ç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ dist/                      # æ‰“åŒ…è¾“å‡º âœ… ä¸Šä¼ åˆ°æœåŠ¡å™¨
â”‚   â”œâ”€â”€ src/
â”‚   â””â”€â”€ package.json
â””â”€â”€ scripts/                       # éƒ¨ç½²è„šæœ¬
    â”œâ”€â”€ deploy-to-tencent.sh       # å®Œæ•´éƒ¨ç½²è„šæœ¬
    â”œâ”€â”€ quick-deploy.sh            # å¿«é€Ÿéƒ¨ç½²è„šæœ¬
    â”œâ”€â”€ server-setup.sh            # æœåŠ¡å™¨åˆå§‹åŒ–è„šæœ¬
    â”œâ”€â”€ nginx-config.conf          # Nginx é…ç½®
    â””â”€â”€ ...
```

### æœåŠ¡å™¨æ–‡ä»¶ç»“æ„
```
/opt/ruizhu-app/
â”œâ”€â”€ nestapi-dist/                  # åç«¯åº”ç”¨ âœ… è¿è¡Œä¸­
â”‚   â”œâ”€â”€ main.js                    # å…¥å£
â”‚   â”œâ”€â”€ node_modules/              # 313 ä¸ªåŒ…
â”‚   â””â”€â”€ ...
â”œâ”€â”€ admin-dist/                    # å‰ç«¯åº”ç”¨ âœ… è¿è¡Œä¸­
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ assets/
â”‚   â””â”€â”€ ...
â””â”€â”€ .env.production                # ç¯å¢ƒå˜é‡

/www/server/nginx/conf/ssl/
â”œâ”€â”€ yunjie.online_bundle.crt       # SSL è¯ä¹¦
â””â”€â”€ yunjie.online.key              # SSL ç§é’¥

/www/server/panel/vhost/nginx/
â””â”€â”€ ruizhu.conf                    # Nginx è™šæ‹Ÿä¸»æœºé…ç½®
```

---

## ğŸ”„ æ›´æ–°å’Œç»´æŠ¤æµç¨‹

### ä»£ç æ›´æ–°
```bash
# 1. æœ¬åœ°æ„å»º
npm run build

# 2. ä¸Šä¼ æ–°ä»£ç 
scp -r dist/ root@123.207.14.67:/opt/ruizhu-app/

# 3. é‡å¯æœåŠ¡
pm2 restart ruizhu-backend

# 4. éªŒè¯
curl https://yunjie.online/api/v1/
```

### è¯ä¹¦æ›´æ–° (æ˜å¹´ 10 æœˆ)
```bash
# 1. è·å–æ–°è¯ä¹¦
# 2. ä¸Šä¼ æ–°è¯ä¹¦
scp cert.crt root@123.207.14.67:/www/server/nginx/conf/ssl/

# 3. é‡å¯ Nginx
systemctl reload nginx

# 4. éªŒè¯
curl -v https://yunjie.online/
```

### ä¾èµ–æ›´æ–°
```bash
# æœ¬åœ°æ›´æ–°
npm update --save

# é‡æ–°æ„å»ºå’Œéƒ¨ç½²
npm run build
# ... ä¸Šä¼  ...
pm2 restart ruizhu-backend
```

---

## âš ï¸ å·²çŸ¥é™åˆ¶å’Œæ³¨æ„äº‹é¡¹

### å½“å‰é™åˆ¶
- æ•°æ®åº“å¤‡ä»½éœ€æ‰‹åŠ¨é…ç½® (å»ºè®®æ¯æ—¥ä¸€æ¬¡)
- æ—¥å¿—éœ€å®šæœŸæ¸…ç† (å»ºè®®æ¯å‘¨ä¸€æ¬¡)
- å†…å­˜é™åˆ¶ 500MB/å®ä¾‹ (å¯æ ¹æ®éœ€è¦è°ƒæ•´)

### å»ºè®®æ”¹è¿›
- [ ] é…ç½®æ•°æ®åº“è‡ªåŠ¨å¤‡ä»½
- [ ] è®¾ç½®æ—¥å¿—è½®è½¬ (logrotate)
- [ ] æ·»åŠ ç›‘æ§å‘Šè­¦ç³»ç»Ÿ
- [ ] é…ç½® CDN åŠ é€Ÿ
- [ ] å®ç°è“ç»¿éƒ¨ç½²

---

## ğŸ“ é—®é¢˜è¯Šæ–­

### å¸¸è§é—®é¢˜é€ŸæŸ¥

**åº”ç”¨æ— æ³•è®¿é—®?**
```bash
ssh root@123.207.14.67
pm2 logs ruizhu-backend        # æŸ¥çœ‹é”™è¯¯
curl http://127.0.0.1:3000     # æµ‹è¯•åç«¯
systemctl status nginx          # æ£€æŸ¥ Nginx
```

**HTTPS è¯ä¹¦é—®é¢˜?**
```bash
openssl x509 -in /www/server/nginx/conf/ssl/yunjie.online_bundle.crt -text -noout
# æ£€æŸ¥è¯ä¹¦ä¿¡æ¯å’Œæœ‰æ•ˆæœŸ
```

**æ€§èƒ½ä¸‹é™?**
```bash
top                             # æŸ¥çœ‹ CPU/å†…å­˜
pm2 monit                       # ç›‘æ§è¿›ç¨‹
curl http://127.0.0.1/api/v1   # æµ‹è¯•å“åº”æ—¶é—´
```

---

## ğŸ“ å­¦ä¹ èµ„æº

### éƒ¨ç½²ç›¸å…³
- [NestJS éƒ¨ç½²æŒ‡å—](https://docs.nestjs.com/deployment)
- [Nginx åå‘ä»£ç†æ–‡æ¡£](http://nginx.org/en/docs/)
- [PM2 å®˜æ–¹æ–‡æ¡£](https://pm2.keymetrics.io/docs)

### å®‰å…¨ç›¸å…³
- [OWASP å®‰å…¨æŒ‡å—](https://owasp.org/)
- [SSL/TLS æœ€ä½³å®è·µ](https://wiki.mozilla.org/Security/Server_Side_TLS)
- [HTTP å®‰å…¨å¤´ä¿¡æ¯](https://securityheaders.com/)

---

## ğŸ“Š éƒ¨ç½²æˆæœ¬ä¼°ç®—

### è…¾è®¯äº‘è´¹ç”¨ (å‚è€ƒ)
```
äº‘æœåŠ¡å™¨ (CVM):        ~Â¥30-50/æœˆ (1æ ¸2GB)
äº‘æ•°æ®åº“ (CDB MySQL):  ~Â¥50-100/æœˆ
åŸŸåæ³¨å†Œ (yunjie.online): ~Â¥50/å¹´
SSL è¯ä¹¦:              Â¥0 (ç°æœ‰è¯ä¹¦ï¼Œæ˜å¹´ç»­è´¹)
æ€»è®¡:                  ~Â¥80-150/æœˆ
```

---

## âœ¨ éƒ¨ç½²äº®ç‚¹

### æŠ€æœ¯äº®ç‚¹
- ğŸ¯ **å…¨æ ˆéƒ¨ç½²**: ä»ç¼–è¯‘åˆ°ä¸Šçº¿ä¸€ä½“åŒ–
- ğŸ”’ **HTTPS åŠ å¯†**: å®Œæ•´çš„ SSL/TLS é…ç½®
- âš¡ **æ€§èƒ½ä¼˜åŒ–**: HTTP/2 + Gzip + ç¼“å­˜
- ğŸ”„ **é«˜å¯ç”¨**: PM2 é›†ç¾¤ + è¿›ç¨‹ç›‘æ§
- ğŸ“Š **å¯æ‰©å±•**: è½»æ¾æ”¯æŒæ°´å¹³æ‰©å±•

### æ–‡æ¡£å®Œæ•´æ€§
- ğŸ“ éƒ¨ç½²æŒ‡å— (DEPLOYMENT_COMPLETE.md)
- ğŸ” SSL æŒ‡å— (SSL_HTTPS_GUIDE.md)
- ğŸ“‹ ç»´æŠ¤æŒ‡å— (æœ¬æ–‡æ¡£)
- ğŸ› ï¸ è‡ªåŠ¨åŒ–è„šæœ¬ (4 ä¸ªéƒ¨ç½²è„šæœ¬)

---

## ğŸ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³éœ€è¦åš
- [ ] ä¿®æ”¹æ•°æ®åº“å¯†ç  (å½“å‰: Pp123456)
- [ ] ä¿®æ”¹ JWT_SECRET (å½“å‰: your-secret-key-change-this)
- [ ] ä¿®æ”¹ SSH å¯†ç æˆ–é…ç½®å¯†é’¥è®¤è¯
- [ ] æµ‹è¯•æ•°æ®åº“å¤‡ä»½æµç¨‹

### çŸ­æœŸè®¡åˆ’ (1-2 å‘¨)
- [ ] é…ç½®ç›‘æ§å‘Šè­¦ç³»ç»Ÿ
- [ ] è®¾ç½®æ—¥å¿—å¤‡ä»½å’Œæ¸…ç†
- [ ] é…ç½® CDN åŠ é€Ÿ
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•

### é•¿æœŸè®¡åˆ’ (1-3 ä¸ªæœˆ)
- [ ] å®ç°è‡ªåŠ¨åŒ–éƒ¨ç½² (CI/CD)
- [ ] é…ç½® Redis ç¼“å­˜
- [ ] å®ç°è“ç»¿éƒ¨ç½²ç­–ç•¥
- [ ] å»ºç«‹ç¾éš¾æ¢å¤æµç¨‹

---

## ğŸ“ˆ æˆåŠŸæŒ‡æ ‡

### ç°åœ¨çš„çŠ¶æ€
```
âœ… åº”ç”¨æ­£åœ¨è¿è¡Œ
âœ… å‰ç«¯å¯ä»¥è®¿é—®
âœ… API å¯ä»¥è°ƒç”¨
âœ… HTTPS å·²é…ç½®
âœ… æ•°æ®åº“å·²åˆå§‹åŒ–
âœ… æ—¥å¿—æ­£å¸¸è®°å½•
âœ… è¯ä¹¦æœ‰æ•ˆæœŸ 365 å¤©
```

### ç†æƒ³ç›®æ ‡
```
â˜‘ï¸  è‡ªåŠ¨åŒ–éƒ¨ç½²æµç¨‹
â˜‘ï¸  99.9% å¯ç”¨æ€§
â˜‘ï¸  < 500ms API å“åº”
â˜‘ï¸  æ¯æ—¥è‡ªåŠ¨å¤‡ä»½
â˜‘ï¸  å®‰å…¨å®¡è®¡åˆæ ¼
â˜‘ï¸  ç›‘æ§å‘Šè­¦å®Œæ•´
```

---

## ğŸ‰ æ€»ç»“

æ‚¨çš„ **Ruizhu ç”µå•†å¹³å°** å·²ç»æˆåŠŸéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒï¼

### æ ¸å¿ƒæˆå°±
- âœ… å®Œæ•´çš„åº”ç”¨æ ˆ: React + NestJS + MySQL
- âœ… ç”Ÿäº§çº§çš„éƒ¨ç½²æ¶æ„
- âœ… ä¼ä¸šçº§çš„å®‰å…¨é…ç½®
- âœ… å®Œå–„çš„æ–‡æ¡£å’Œè„šæœ¬

### ç°åœ¨æ‚¨å¯ä»¥
- ğŸš€ ç«‹å³æŠ•å…¥ç”Ÿäº§ä½¿ç”¨
- ğŸ” å®‰å¿ƒæä¾› HTTPS æœåŠ¡
- ğŸ“Š ç›‘æ§åº”ç”¨æ€§èƒ½
- ğŸ”„ å¿«é€Ÿå“åº”æ›´æ–°éœ€æ±‚

---

**æ„Ÿè°¢ä½¿ç”¨ Claude Code å®Œæˆéƒ¨ç½²ï¼**

ç¥æ‚¨çš„ Ruizhu ç”µå•†å¹³å°è¿è¥æˆåŠŸï¼ğŸŠ

---

**éƒ¨ç½²æ—¥æœŸ**: 2025-10-26
**éƒ¨ç½²ç‰ˆæœ¬**: 1.0.0
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª
**ä¸‹æ¬¡è¯„ä¼°**: 2025-11-26
