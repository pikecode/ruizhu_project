import{r as o,j as e}from"./index-DOxEGdKT.js";import{L as D}from"./Layout-BE-ntlVZ.js";import{C as i,O as s,T as d,E as y,a as F,S as P}from"./i18n-B411-pDw.js";import{a as w}from"./api-CLxMmQJN.js";import{B as c}from"./button-DgKdKgQi.js";import{R as _,M as $}from"./ReloadOutlined-6BN3SnDC.js";import{C as R}from"./index-50YUuaol.js";import{R as L,C as u}from"./row-BwxrU85I.js";import{I as N}from"./index-BSvmuOKN.js";import{R as B}from"./Input-CUo6ECZN.js";import{S as U,F as G,T as b,R as V}from"./DeleteOutlined-BiMnbOGP.js";import{S as I}from"./index-C87imYVj.js";import{s as m,R as q}from"./index-BXb1MVlp.js";import"./UserOutlined-8APkalxd.js";import"./ExclamationCircleFilled-Byg_8rfJ.js";import"./CloseCircleFilled-CLg-dlze.js";function ce(){const[v,k]=o.useState([]),[x,f]=o.useState(!1),[h,S]=o.useState(""),[p,j]=o.useState(""),[r,T]=o.useState({current:1,pageSize:10,total:0}),l=async(t=1,a=10)=>{f(!0);try{const n={page:t,limit:a};h&&(n.search=h),p&&(n.status=p);const C=(await w.get("/orders",{params:n})).data;k(C.data||[]),T({...r,total:C.total||0,current:t})}catch(n){console.error("获取订单列表失败:",n),m.error(y.loadFailed)}finally{f(!1)}},E=async t=>{try{await w.delete(`/orders/${t}`),m.success(P.deleteSuccess),l(r.current,r.pageSize)}catch(a){console.error("删除订单失败:",a),m.error(y.deleteFailed)}},z=t=>{$.info({title:"订单详情",content:`查看详情功能开发中... (订单ID: ${t})`})},O=()=>{l(1,r.pageSize)},g=()=>{l(1,r.pageSize)},M=()=>{S(""),j(""),l(1,r.pageSize)};o.useEffect(()=>{l()},[]);const A=[{title:"订单ID",dataIndex:"id",key:"id",width:80},{title:"用户",dataIndex:"user",key:"user",width:120},{title:d.total,dataIndex:"totalPrice",key:"totalPrice",width:100,render:t=>`¥${t.toFixed(2)}`},{title:d.status,dataIndex:"status",key:"status",width:120,render:t=>{const a=s[t];return a?e.jsx(b,{color:a.color,children:a.label}):e.jsx(b,{children:t})}},{title:d.created,dataIndex:"createdAt",key:"createdAt",width:150,render:t=>new Date(t).toLocaleDateString("zh-CN")},{title:d.actions,key:"actions",width:150,render:(t,a)=>e.jsxs(I,{children:[e.jsx(c,{type:"primary",size:"small",icon:e.jsx(q,{}),onClick:()=>z(a.id),children:i.view}),e.jsx(F,{title:"删除订单",description:"确定要删除这个订单吗？",onConfirm:()=>E(a.id),okText:"确定",cancelText:"取消",okButtonProps:{danger:!0},children:e.jsx(c,{danger:!0,size:"small",icon:e.jsx(V,{}),children:i.delete})})]})}];return e.jsx(D,{children:e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"flex-between mb-4",children:[e.jsx("h1",{children:"订单列表"}),e.jsx(c,{icon:e.jsx(_,{}),onClick:O,loading:x,children:i.refresh})]}),e.jsx(R,{style:{marginBottom:16},children:e.jsxs(L,{gutter:16,children:[e.jsx(u,{span:8,children:e.jsx(N.Search,{placeholder:"搜索订单ID或用户...",icon:e.jsx(B,{}),value:h,onChange:t=>S(t.target.value),onSearch:g,allowClear:!0})}),e.jsx(u,{span:8,children:e.jsx(U,{placeholder:"选择订单状态",style:{width:"100%"},value:p,onChange:t=>j(t),allowClear:!0,options:[{label:s.pending.label,value:"pending"},{label:s.confirmed.label,value:"confirmed"},{label:s.shipped.label,value:"shipped"},{label:s.delivered.label,value:"delivered"},{label:s.cancelled.label,value:"cancelled"},{label:s.refunded.label,value:"refunded"}]})}),e.jsx(u,{span:8,children:e.jsxs(I,{style:{width:"100%",justifyContent:"flex-end"},children:[e.jsx(c,{type:"primary",onClick:g,children:i.search}),e.jsx(c,{onClick:M,children:i.reset})]})})]})}),e.jsx(R,{children:e.jsx(G,{columns:A,dataSource:v.map(t=>({...t,key:t.id})),loading:x,pagination:{current:r.current,pageSize:r.pageSize,total:r.total,showSizeChanger:!0,showTotal:t=>`共 ${t} 条记录`,onChange:(t,a)=>l(t,a)},scroll:{x:1200}})})]})})}export{ce as default};
