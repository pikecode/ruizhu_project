import{r as c,j as e}from"./index-DOxEGdKT.js";import{L as $}from"./Layout-BE-ntlVZ.js";import{C as o,T as n,E as j,P as _,a as A,S as O}from"./i18n-B411-pDw.js";import{a as g}from"./api-CLxMmQJN.js";import{S as p}from"./index-C87imYVj.js";import{B as i}from"./button-DgKdKgQi.js";import{M as y,R as B}from"./ReloadOutlined-6BN3SnDC.js";import{R as F,C}from"./index-50YUuaol.js";import{R as L,C as R}from"./row-BwxrU85I.js";import{I as N}from"./index-BSvmuOKN.js";import{R as b}from"./Input-CUo6ECZN.js";import{F as v,T as k,R as D}from"./DeleteOutlined-BiMnbOGP.js";import{s as h}from"./index-BXb1MVlp.js";import{R as U}from"./EditOutlined-D9s6iUJU.js";import"./UserOutlined-8APkalxd.js";import"./ExclamationCircleFilled-Byg_8rfJ.js";import"./CloseCircleFilled-CLg-dlze.js";function ie(){const[I,w]=c.useState([]),[m,x]=c.useState(!1),[d,u]=c.useState(""),[a,T]=c.useState({current:1,pageSize:10,total:0}),s=async(t=1,r=10)=>{x(!0);try{const l={page:t,limit:r};d&&(l.search=d);const S=(await g.get("/products",{params:l})).data;w(S.data||[]),T({...a,total:S.total||0,current:t})}catch(l){console.error("获取产品列表失败:",l),h.error(j.loadFailed)}finally{x(!1)}},E=async t=>{try{await g.delete(`/products/${t}`),h.success(O.deleteSuccess),s(a.current,a.pageSize)}catch(r){console.error("删除产品失败:",r),h.error(j.deleteFailed)}},z=()=>{s(1,a.pageSize)},f=()=>{s(1,a.pageSize)},P=()=>{u(""),s(1,a.pageSize)};c.useEffect(()=>{s()},[]);const M=[{title:"ID",dataIndex:"id",key:"id",width:80},{title:n.name,dataIndex:"name",key:"name",ellipsis:!0},{title:n.category,dataIndex:"category",key:"category",width:120},{title:n.price,dataIndex:"price",key:"price",width:100,render:t=>`¥${t.toFixed(2)}`},{title:n.stock,dataIndex:"stock",key:"stock",width:80},{title:n.status,dataIndex:"status",key:"status",width:100,render:t=>{const r=_[t];return r?e.jsx(k,{color:r.color,children:r.label}):e.jsx(k,{children:t})}},{title:n.actions,key:"actions",width:150,render:(t,r)=>e.jsxs(p,{children:[e.jsx(i,{type:"primary",size:"small",icon:e.jsx(U,{}),onClick:()=>{y.info({title:"编辑产品",content:`编辑功能开发中... (ID: ${r.id})`})},children:o.edit}),e.jsx(A,{title:"删除产品",description:"确定要删除这个产品吗？",onConfirm:()=>E(r.id),okText:"确定",cancelText:"取消",okButtonProps:{danger:!0},children:e.jsx(i,{danger:!0,size:"small",icon:e.jsx(D,{}),children:o.delete})})]})}];return e.jsx($,{children:e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"flex-between mb-4",children:[e.jsx("h1",{children:"产品列表"}),e.jsxs(p,{children:[e.jsxs(i,{type:"primary",icon:e.jsx(F,{}),onClick:()=>{y.info({title:"新增产品",content:"新增产品功能开发中..."})},children:[o.add,"产品"]}),e.jsx(i,{icon:e.jsx(B,{}),onClick:z,loading:m,children:o.refresh})]})]}),e.jsx(C,{style:{marginBottom:16},children:e.jsxs(L,{gutter:16,children:[e.jsx(R,{span:12,children:e.jsx(N.Search,{placeholder:"搜索产品名称...",icon:e.jsx(b,{}),value:d,onChange:t=>u(t.target.value),onSearch:f,allowClear:!0})}),e.jsx(R,{span:12,children:e.jsxs(p,{children:[e.jsx(i,{type:"primary",onClick:f,children:o.search}),e.jsx(i,{onClick:P,children:o.reset})]})})]})}),e.jsx(C,{children:e.jsx(v,{columns:M,dataSource:I.map(t=>({...t,key:t.id})),loading:m,pagination:{current:a.current,pageSize:a.pageSize,total:a.total,showSizeChanger:!0,showTotal:t=>`共 ${t} 条记录`,onChange:(t,r)=>s(t,r)},scroll:{x:1200}})})]})})}export{ie as default};
